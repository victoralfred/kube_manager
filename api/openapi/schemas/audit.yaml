AuditLog:
  type: object
  required:
    - id
    - tenant_id
    - action
    - resource_type
    - actor_id
    - timestamp
  properties:
    id:
      type: string
      format: uuid
      description: Unique audit log identifier
      example: "bb0e8400-e29b-41d4-a716-446655440000"
    tenant_id:
      type: string
      format: uuid
      description: Tenant identifier
      example: "550e8400-e29b-41d4-a716-446655440000"
    action:
      type: string
      description: Action performed
      example: "user.created"
    resource_type:
      type: string
      description: Type of resource affected
      example: "user"
    resource_id:
      type: string
      format: uuid
      nullable: true
      description: Identifier of affected resource
      example: "660e8400-e29b-41d4-a716-446655440000"
    actor_id:
      type: string
      format: uuid
      description: User who performed the action
      example: "660e8400-e29b-41d4-a716-446655440000"
    actor_email:
      type: string
      format: email
      description: Email of user who performed the action
      example: "admin@example.com"
    ip_address:
      type: string
      nullable: true
      description: IP address of the actor
      example: "192.168.1.100"
    user_agent:
      type: string
      nullable: true
      description: User agent string
      example: "Mozilla/5.0 (Windows NT 10.0; Win64; x64)"
    status:
      type: string
      enum:
        - success
        - failure
        - pending
      description: Action status
      example: "success"
    changes:
      type: object
      description: Changes made (before/after)
      properties:
        before:
          type: object
          additionalProperties: true
        after:
          type: object
          additionalProperties: true
      example:
        before:
          status: "inactive"
        after:
          status: "active"
    metadata:
      type: object
      description: Additional metadata
      additionalProperties: true
      example:
        request_id: "req_123456"
        duration_ms: 152
    timestamp:
      type: string
      format: date-time
      description: When the action occurred
      example: "2025-10-15T10:30:00Z"

AuditLogFilter:
  type: object
  properties:
    action:
      type: string
      description: Filter by action
      example: "user.created"
    resource_type:
      type: string
      description: Filter by resource type
      example: "user"
    resource_id:
      type: string
      format: uuid
      description: Filter by resource ID
      example: "660e8400-e29b-41d4-a716-446655440000"
    actor_id:
      type: string
      format: uuid
      description: Filter by actor ID
      example: "660e8400-e29b-41d4-a716-446655440000"
    status:
      type: string
      enum:
        - success
        - failure
        - pending
      description: Filter by status
      example: "success"
    start_date:
      type: string
      format: date-time
      description: Filter logs from this date
      example: "2025-10-01T00:00:00Z"
    end_date:
      type: string
      format: date-time
      description: Filter logs until this date
      example: "2025-10-15T23:59:59Z"
    limit:
      type: integer
      minimum: 1
      maximum: 100
      default: 10
      description: Number of results
      example: 10
    offset:
      type: integer
      minimum: 0
      default: 0
      description: Offset for pagination
      example: 0

CreateAuditLogRequest:
  type: object
  required:
    - action
    - resource_type
    - actor_id
  properties:
    action:
      type: string
      description: Action performed
      example: "tenant.updated"
    resource_type:
      type: string
      description: Type of resource affected
      example: "tenant"
    resource_id:
      type: string
      format: uuid
      description: Identifier of affected resource
      example: "550e8400-e29b-41d4-a716-446655440000"
    actor_id:
      type: string
      format: uuid
      description: User who performed the action
      example: "660e8400-e29b-41d4-a716-446655440000"
    ip_address:
      type: string
      description: IP address of the actor
      example: "192.168.1.100"
    user_agent:
      type: string
      description: User agent string
      example: "Mozilla/5.0"
    status:
      type: string
      enum:
        - success
        - failure
        - pending
      description: Action status
      example: "success"
    changes:
      type: object
      description: Changes made
      additionalProperties: true
    metadata:
      type: object
      description: Additional metadata
      additionalProperties: true
