LoginRequest:
  type: object
  required:
    - email
    - password
  properties:
    email:
      type: string
      format: email
      description: User email
      example: "user@example.com"
    password:
      type: string
      format: password
      description: User password
      example: "SecureP@ssw0rd"
    tenant_id:
      type: string
      format: uuid
      description: Optional tenant ID for multi-tenant users
      example: "550e8400-e29b-41d4-a716-446655440000"

LoginResponse:
  type: object
  required:
    - access_token
    - refresh_token
    - token_type
    - expires_in
    - expires_at
    - user
  properties:
    access_token:
      type: string
      description: JWT access token
      example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
    refresh_token:
      type: string
      description: JWT refresh token
      example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
    token_type:
      type: string
      description: Token type
      example: "Bearer"
    expires_in:
      type: integer
      description: Token expiration time in seconds
      example: 900
    expires_at:
      type: string
      format: date-time
      description: Exact expiration timestamp
      example: "2025-10-17T00:30:00Z"
    user:
      $ref: './user.yaml#/User'

RegisterRequest:
  type: object
  required:
    - email
    - password
    - first_name
    - last_name
    - tenant_slug
  properties:
    email:
      type: string
      format: email
      description: User email
      example: "newuser@example.com"
    password:
      type: string
      format: password
      minLength: 8
      description: User password
      example: "SecureP@ssw0rd"
    first_name:
      type: string
      description: First name
      example: "John"
    last_name:
      type: string
      description: Last name
      example: "Doe"
    username:
      type: string
      minLength: 3
      maxLength: 50
      description: Username
      example: "john_doe"
    tenant_slug:
      type: string
      description: Tenant slug to register under
      example: "acme-corp"

RefreshTokenRequest:
  type: object
  required:
    - refresh_token
  properties:
    refresh_token:
      type: string
      description: Refresh token
      example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."

TokenResponse:
  type: object
  required:
    - access_token
    - token_type
    - expires_in
  properties:
    access_token:
      type: string
      description: New JWT access token
      example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
    token_type:
      type: string
      description: Token type
      example: "Bearer"
    expires_in:
      type: integer
      description: Token expiration time in seconds
      example: 900

JWTClaims:
  type: object
  properties:
    sub:
      type: string
      format: uuid
      description: Subject (user ID)
      example: "660e8400-e29b-41d4-a716-446655440000"
    tenant_id:
      type: string
      format: uuid
      description: Tenant ID
      example: "550e8400-e29b-41d4-a716-446655440000"
    email:
      type: string
      format: email
      description: User email
      example: "user@example.com"
    roles:
      type: array
      items:
        type: string
      description: User roles
      example: ["admin", "user"]
    exp:
      type: integer
      description: Expiration time (Unix timestamp)
      example: 1697456789
    iat:
      type: integer
      description: Issued at time (Unix timestamp)
      example: 1697456189
